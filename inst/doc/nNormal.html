<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Two-sample normal sample size</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Two-sample normal sample size</h1>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Limited support is provided for 2-sample design with a normally distributed random variable as the outcome. Users are encouraged to look at guidance such as in <span class="citation">Jennison and Turnbull (2000)</span>. We provide a tool where for a large sample case where a reasonable estimate of standard deviation is available, a reasonable sample size can be computed based straightforward distribution theory outlined below.</p>
</div>
<div id="the-problem-considered" class="section level1">
<h1>The problem considered</h1>
<p>The overall sample size notation used for <strong>gsDesign</strong> is to consider a standardized effect size parameter which is referred to as <span class="math inline">\(\theta\)</span> in <span class="citation">Jennison and Turnbull (2000)</span>. We begin with the 2-sample normal problem where we assume a possibly different standard deviation in each treatment group. For <span class="math inline">\(j=1,2\)</span>, we let <span class="math inline">\(X_{j,i}\)</span>, <span class="math inline">\(i=1,2,\ldots n_j\)</span> represent independent and identically distributed observations following a normal distribution with mean <span class="math inline">\(\mu_j\)</span> and standard deviation <span class="math inline">\(\sigma_j\)</span>. The natural parameter for comparing the two distributions is</p>
<p><span class="math display">\[\delta = \mu_2 - \mu_1\]</span></p>
<p>and we wish to test if <span class="math inline">\(\delta &gt; 0\)</span> in a one-sided testing scenario to test for superiority of treatment 2 over treatment 1. We could also consider testing, say, <span class="math inline">\(\delta &gt; \delta_0\)</span> for a non-inferiority scenario with <span class="math inline">\(\delta_0&lt;0\)</span> or <strong>super superiority</strong> if <span class="math inline">\(\delta_0&gt;0\)</span>. While normally a t-test would be used for this, for large sample sizes this would be nearly equivalent to a Z-test defined by:</p>
<p><span class="math display">\[Z=\frac{\bar X_2 - \bar X_1-\delta_0}{\sqrt{\sigma^2_2/n_2 + \sigma_1^2/n_1}}\approx \frac{\bar X_2 - \bar X_1}{\sqrt{s^2_2/n_2 + s_1^2/n_1}}=t\]</span> where <span class="math inline">\(\bar X_j\)</span> is the sample mean and <span class="math inline">\(s_j^2\)</span> is the sample variance for group <span class="math inline">\(j=1,2\)</span>. The far right hand side of this is Welch’s t-test. For our examples we use this <span class="math inline">\(t\)</span>-test and show that the sample size computation based on the <span class="math inline">\(Z\)</span>-test above works well for the chosen problems.</p>
</div>
<div id="sample-size" class="section level1">
<h1>Sample size</h1>
<p>Thus, <span class="math inline">\(n_2=rn/(1+r)\)</span>, <span class="math inline">\(n_1=n/(1+r)\)</span> and when <span class="math inline">\(r=1\)</span> we have <span class="math inline">\(n_1=n_2=n/2\)</span>. Now that we have completed needed notation, those not interested in the theory behind the sample size and power calculation used may skip the rest of this section.</p>
<p>We let <span class="math display">\[\sigma^2=(1+r)(\sigma_1^2+\sigma_2^2/r)\]</span> and define <span class="math display">\[ \theta= (\delta -\delta_0)/\sigma.\]</span> Under the given assumptions, <span class="math display">\[Z \sim \hbox{Normal}\left(\sqrt n\theta,1\right).\]</span> Under the null hypothesis that <span class="math inline">\(\delta=\delta_0\)</span>, we have <span class="math inline">\(Z\sim \hbox{Normal}(0,1)\)</span>. Thus, regardless of <span class="math inline">\(n\)</span> we have <span class="math display">\[P_0[Z\ge \Phi^{-1}(1-\alpha)]=\alpha.\]</span> Under the alternate hypothesis that <span class="math inline">\(\delta=\delta_1\)</span> and we denote a corresponding <span class="math inline">\(\theta_1\)</span>. We define the type 2 error <span class="math inline">\(\beta\)</span> and power <span class="math inline">\(1-\beta\)</span> by</p>
<p><span class="math display">\[
\begin{align}
1-\beta =&amp; P_1[Z\ge \Phi^{-1}(1-\alpha)]\\
=&amp; P[Z-\sqrt n\theta_1\ge \Phi^{-1}(1-\alpha)-\sqrt n\theta_1]\\
=&amp;\Phi(\Phi^{-1}(1-\alpha)-\sqrt n\theta_1)).
\end{align}\]</span></p>
<p>If the power <span class="math inline">\(1-\beta\)</span> is fixed, we can invert this formula to compute sample size with:</p>
<p><span class="math display">\[n= \left(\frac{\Phi^{-1}(1-\beta)+\Phi^{-1}(1-\alpha)}{\theta_1}\right)^2.\]</span></p>
<p>For 2-sided testing, we simply substitute <span class="math inline">\(\alpha/2\)</span> for <span class="math inline">\(\alpha\)</span> in the above two formulas.</p>
</div>
<div id="examples" class="section level1">
<h1>Examples</h1>
<p>We consider two examples to check the above formulas vs. <code>nNormal()</code>. We then confirm that the approximation is working well by simulating and confirming that the power and Type I error approximations are useful. Finally, we provide a simple group sequential design example.</p>
<div id="sample-size-1" class="section level2">
<h2>Sample size</h2>
<p>We consider an example with <span class="math inline">\(\sigma_2=1.25\)</span>, <span class="math inline">\(\sigma_1=1.6\)</span>, <span class="math inline">\(\delta=0.8\)</span> and <span class="math inline">\(\delta_0=0\)</span>. We let the sample size ratio be 2 experimental group observations per control observation. We compute sample size with <code>nNormal()</code> assuming one-sided Type I error <span class="math inline">\(\alpha=0.025\)</span> and 90% power (<span class="math inline">\(1-\beta=0.9\)</span>).</p>
<p>Checking using the sample size formula above, we have:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((<span class="dv">1</span><span class="sc">+</span>r)<span class="sc">*</span>(<span class="fl">1.6</span><span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fl">1.25</span><span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>r)) </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fl">0.8</span><span class="sc">/</span>sigma</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>((<span class="fu">qnorm</span>(.<span class="dv">9</span>)<span class="sc">+</span><span class="fu">qnorm</span>(.<span class="dv">975</span>))<span class="sc">/</span>theta)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 164.5684</span></span></code></pre></div>
</div>
<div id="power" class="section level2">
<h2>Power</h2>
<p>Now, assume we let the sample size be 200 and compute power under the same scenario.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">nNormal</span>(<span class="at">delta1=</span><span class="fl">0.8</span>, <span class="at">sd =</span> <span class="fl">1.6</span>, <span class="at">sd2 =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.025</span>, <span class="at">n =</span> <span class="dv">200</span>, <span class="at">ratio =</span> <span class="dv">2</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.9466825</span></span></code></pre></div>
<p>From the power formula above, we duplicate this with:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pwr <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(<span class="fu">qnorm</span>(.<span class="dv">975</span>) <span class="sc">-</span> <span class="fu">sqrt</span>(<span class="dv">200</span>) <span class="sc">*</span> theta, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>pwr</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.9466825</span></span></code></pre></div>
<p>If we want to plot power for a variety of sample sizes, we can input <code>n</code> as a vector:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span><span class="sc">:</span><span class="dv">200</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>pwrn <span class="ot">&lt;-</span> <span class="fu">nNormal</span>(<span class="at">delta1 =</span> <span class="fl">0.8</span>, <span class="at">sd =</span> <span class="fl">1.6</span>, <span class="at">sd2 =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.025</span>, <span class="at">n =</span> n, <span class="at">ratio =</span> <span class="dv">2</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n, pwrn, <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Alternatively, you could fix sample size at 200 and plot power under different treatment effect assumptions:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>delta1 <span class="ot">&lt;-</span> <span class="fu">seq</span>(.<span class="dv">5</span>,<span class="dv">1</span>,.<span class="dv">025</span>)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>pwrdelta1 <span class="ot">&lt;-</span> <span class="fu">nNormal</span>(<span class="at">delta1 =</span> delta1, <span class="at">sd =</span> <span class="fl">1.6</span>, <span class="at">sd2 =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.025</span>, <span class="at">n =</span> <span class="dv">200</span>, <span class="at">ratio =</span> <span class="dv">2</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(delta1, pwrdelta1, <span class="at">type=</span><span class="st">&quot;l&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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F6tFixYyf/58dQjnMTdTtmxZ2bZtW+CyYsWKycyZM8UUKdvVKlNIZNeuXeqz5v+RHDlyRPC9d+/eFVOcAt/JF+4lQAFyb9tpK/mlS5eUgGDYFZxy5swZeAuxQOrSpYt6jv4H58NZLt+yZYv0799f1q9fr0QHc0CYL0qdOnX0r+R7FxLgHJALG013kdOnT68mhC9fvhylKMG9kgwZMqhza9euVcKBc8EPzNvYpTNnzkjdunXl2rVrah7o1KlTsn//fnniiSfsPsrzLiFAAXJJQzmpmI888oiY8zACcQlOMCK0UtGiRdXLBQsWCIZS1mPGjBnSqVMnuX37tnVp4BlGjEgYYiGtWbNGzLkkJT4Y3mXPnl2d27Nnj/z+++/qGv5xNwEKkLvbT1vpe/XqJbNnz1YrYFevXhVzolhGjRoVKI850axWsrBCNm7cOEFvafny5fLGG29Irly5BBbQ0VOSJEnU8dWrVwtW2bAsD7GDaP36669y+vRptap26NChKMvw0b+H711EwOGT5CyegwmYy+FGjhw51MqVaQtkDB06NLAKhmKbomOYy+iGKSzquNmDMTp06GCYcziBWgWvguGgaeOjrs+cObO6ZtCgQYY5t2TgOjxef/11w1zeV6/NuajA91gvuApmkXDHcyIU00V6yaI6jABun2PHjknu3LlVbyVU8WBMePLkScmXL19YRoLYTIphGAwPkZAHJq3Rc0qaNGmoLHjMpQQoQC5tOBabBLxAgHNAXmhF1oEEXEqAAuTShmOxScALBChAXmhF1oEEXEqAAuTShmOxScALBChAXmhF1oEEXEqAAuTShmOxScALBChAXmhF1oEEXEqAAuTShmOxScALBChAXmhF1oEEXEqAAuTShmOxScALBChAXmhF1oEEXEqAAuTShmOxScALBChAXmhF1oEEXEqAAuTShmOxScALBChAXmhF1oEEXEqAAuTShmOxScALBChAXmhF1oEEXEqAAuTShmOxScALBChAXmhF1oEEXEqAAuTShmOxScALBChAXmhF1oEEXEqAAuTShmOxScALBP4Hk6HL4SaFojAAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="verification-with-simulation" class="section level2">
<h2>Verification with simulation</h2>
<p>Rather than simulate individual observations, we will take advantage of the fact that for <span class="math inline">\(j=1,2\)</span></p>
<p><span class="math display">\[\bar X_j\sim \hbox{Normal}(\mu_j,\sigma_j^2/n_j)\]</span> and</p>
<p><span class="math display">\[(n_j-1)s_j^2/\sigma_j^2=\sum_{i=1}^{n_j} (X_{ij}-\bar X_j)/\sigma^2 \sim \chi ^2_{n_j-1}\]</span></p>
<p>are independent. Thus, we can simulate trial power with <span class="math inline">\(n=200\)</span> 1 million times with a t-statistic with unequal variances quickly as follows under the alternate hypothesis:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>nsim <span class="ot">&lt;-</span> <span class="dv">1000000</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>sd1 <span class="ot">&lt;-</span> <span class="fl">1.6</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>sd2 <span class="ot">&lt;-</span> <span class="fl">1.25</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">67</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">133</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>deltahat <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>nsim, <span class="at">mean=</span>delta, <span class="at">sd=</span>sd1<span class="sc">/</span><span class="fu">sqrt</span>(n1)) <span class="sc">-</span> <span class="fu">rnorm</span>(<span class="at">n=</span>nsim, <span class="at">mean=</span><span class="dv">0</span>, <span class="at">sd=</span>sd2<span class="sc">/</span><span class="fu">sqrt</span>(n2))</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(sd1<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">rchisq</span>(<span class="at">n=</span>nsim, <span class="at">df=</span>n1 <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>(n1<span class="dv">-1</span>)<span class="sc">/</span>n1 <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>           sd2<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">rchisq</span>(<span class="at">n=</span>nsim, <span class="at">df=</span>n2 <span class="sc">-</span> <span class="dv">1</span>)<span class="sc">/</span>(n2<span class="dv">-1</span>)<span class="sc">/</span>n2)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> deltahat <span class="sc">/</span> s</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(z <span class="sc">&gt;=</span> <span class="fu">qnorm</span>(.<span class="dv">975</span>))</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.946126</span></span></code></pre></div>
<p>The standard error for this simulation power calculation is approximately</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sqrt</span>(pwr<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>pwr)<span class="sc">/</span>nsim)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.0002246659</span></span></code></pre></div>
<p>suggesting we should be within less than about 0.001 if the actual power, which suggests the normal power approximation is reasonable for this scenario.</p>
</div>
<div id="group-sequential-design" class="section level2">
<h2>Group sequential design</h2>
<p>Now we derive a group sequential design under the above scenario. We will largely use default parameters and show two methods. For the first, we plug in the fixed sample size above as follows:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">gsDesign</span>(<span class="at">k=</span><span class="dv">2</span>,</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">n.fix =</span> <span class="fu">nNormal</span>(<span class="at">delta1=</span><span class="fl">0.8</span>, <span class="at">sd =</span> <span class="fl">1.6</span>, <span class="at">sd2 =</span> <span class="fl">1.25</span>, <span class="at">alpha =</span> <span class="fl">0.025</span>, <span class="at">beta =</span> .<span class="dv">1</span>, <span class="at">ratio =</span> <span class="dv">2</span>),</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">delta1 =</span> <span class="fl">0.8</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>d <span class="sc">%&gt;%</span>  <span class="fu">gsBoundSummary</span>(<span class="at">deltaname =</span> <span class="st">&quot;Mean difference&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">row.names =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Analysis</th>
<th align="left">Value</th>
<th align="right">Efficacy</th>
<th align="right">Futility</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">IA 1: 50%</td>
<td align="left">Z</td>
<td align="right">2.7500</td>
<td align="right">0.4122</td>
</tr>
<tr class="even">
<td align="left">N: 86</td>
<td align="left">p (1-sided)</td>
<td align="right">0.0030</td>
<td align="right">0.3401</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">~Mean difference at bound</td>
<td align="right">0.9399</td>
<td align="right">0.1409</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">P(Cross) if Mean difference=0</td>
<td align="right">0.0030</td>
<td align="right">0.6599</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">P(Cross) if Mean difference=0.8</td>
<td align="right">0.3412</td>
<td align="right">0.0269</td>
</tr>
<tr class="even">
<td align="left">Final</td>
<td align="left">Z</td>
<td align="right">1.9811</td>
<td align="right">1.9811</td>
</tr>
<tr class="odd">
<td align="left">N: 172</td>
<td align="left">p (1-sided)</td>
<td align="right">0.0238</td>
<td align="right">0.0238</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">~Mean difference at bound</td>
<td align="right">0.4788</td>
<td align="right">0.4788</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">P(Cross) if Mean difference=0</td>
<td align="right">0.0239</td>
<td align="right">0.9761</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">P(Cross) if Mean difference=0.8</td>
<td align="right">0.9000</td>
<td align="right">0.1000</td>
</tr>
</tbody>
</table>
<p>A textual summary of the design is given by:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="fu">summary</span>(d))</span></code></pre></div>
<p>Asymmetric two-sided group sequential design with non-binding futility bound, 2 analyses, sample size 172, 90 percent power, 2.5 percent (1-sided) Type I error. Efficacy bounds derived using a Hwang-Shih-DeCani spending function with gamma = -4. Futility bounds derived using a Hwang-Shih-DeCani spending function with gamma = -2.</p>
<p>We can get the same answer by plugging in the standardized effect size we computed above:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gsDesign</span>(<span class="at">k=</span><span class="dv">2</span>,</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">delta =</span> theta,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">delta1 =</span> <span class="fl">0.8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gsBoundSummary</span>(<span class="at">deltaname =</span> <span class="st">&quot;Mean difference&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">row.names=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Analysis</th>
<th align="left">Value</th>
<th align="right">Efficacy</th>
<th align="right">Futility</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">IA 1: 50%</td>
<td align="left">Z</td>
<td align="right">2.7500</td>
<td align="right">0.4122</td>
</tr>
<tr class="even">
<td align="left">N: 86</td>
<td align="left">p (1-sided)</td>
<td align="right">0.0030</td>
<td align="right">0.3401</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">~Mean difference at bound</td>
<td align="right">0.9399</td>
<td align="right">0.1409</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">P(Cross) if Mean difference=0</td>
<td align="right">0.0030</td>
<td align="right">0.6599</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">P(Cross) if Mean difference=0.8</td>
<td align="right">0.3412</td>
<td align="right">0.0269</td>
</tr>
<tr class="even">
<td align="left">Final</td>
<td align="left">Z</td>
<td align="right">1.9811</td>
<td align="right">1.9811</td>
</tr>
<tr class="odd">
<td align="left">N: 172</td>
<td align="left">p (1-sided)</td>
<td align="right">0.0238</td>
<td align="right">0.0238</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">~Mean difference at bound</td>
<td align="right">0.4788</td>
<td align="right">0.4788</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">P(Cross) if Mean difference=0</td>
<td align="right">0.0239</td>
<td align="right">0.9761</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">P(Cross) if Mean difference=0.8</td>
<td align="right">0.9000</td>
<td align="right">0.1000</td>
</tr>
</tbody>
</table>
<p>We leave it to the reader to verify the properties of the above design using simulation as in the fixed design example.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="unnumbered">References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-JTBook" class="csl-entry">
Jennison, Christopher, and Bruce W. Turnbull. 2000. <em>Group Sequential Methods with Applications to Clinical Trials</em>. Boca Raton, FL: Chapman; Hall/CRC.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
